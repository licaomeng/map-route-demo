(this["webpackJsonpmap-route-demo"]=this["webpackJsonpmap-route-demo"]||[]).push([[0],{103:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),i=n.n(o),c=(n(90),n(16)),l=n.n(c),u=n(25),s=n(47),d=n(48),f=n(67),m=n(42),g=n(23),p=n(150),h=n(157),v=n(148),b=n(72),w=n.n(b),j=n(27),E=n(59),O=n(152),x=n(153),y=n(74);function k(){return C.apply(this,arguments)}function C(){return(C=Object(u.a)(l.a.mark((function e(){var t,n,a,r,o,i,c,u,s,d,f,m,g=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=g.length,n=new Array(t),a=0;a<t;a++)n[a]=g[a];if(r=n[0],o=n[1],i=n[2],!((c=void 0===i?0:i)>=5)){e.next=4;break}return e.abrupt("return",Promise.reject("request time out"));case 4:return e.next=6,fetch(r,o);case 6:if(!(u=e.sent).ok){e.next=19;break}return e.next=10,u.json();case 10:if(s=e.sent,d=s.status,f=s.error,m=Object(y.a)(s,["status","error"]),"failure"!==d){e.next=14;break}return e.abrupt("return",Promise.reject(f));case 14:if("in progress"!==d){e.next=16;break}return e.abrupt("return",k(r,o,++c));case 16:return e.abrupt("return",Promise.resolve(m));case 19:if(500!==u.status){e.next=23;break}return e.abrupt("return",Promise.reject("Internal Server Error"));case 23:return e.abrupt("return",Promise.reject("request failed"));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=k;function N(e){var t=e.label,n=e.latitude,o=e.longitude,i=e.onChange,c=e.onLocationChange,s=e.value,d={options:[],getOptionLabel:function(e){return(null===e||void 0===e?void 0:e.text)||""}},f=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"pk.eyJ1IjoibGljYW9tZW5nIiwiYSI6ImNrZ2NnbmRxNzA0anAydWw4cDhkeW15OGEifQ.fy4izQyEJV3Ld-J0piVWBg",r=[o,n],e.next=4,I("//api.mapbox.com/geocoding/v5/mapbox.places/".concat(encodeURI(t),".json?proximity=").concat(r,"&access_token=").concat("pk.eyJ1IjoibGljYW9tZW5nIiwiYSI6ImNrZ2NnbmRxNzA0anAydWw4cDhkeW15OGEifQ.fy4izQyEJV3Ld-J0piVWBg"));case 4:return i=e.sent,j(Object(m.a)({},d,{options:i.features})),e.abrupt("return",null===(a=i.features)||void 0===a?void 0:a[0]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current}(s);Object(a.useEffect)((function(){s&&!p?f(s).then((function(e){C(e),c(null===e||void 0===e?void 0:e.text)})):s||C("")}),[s]);var h,v=Object(a.useState)(d),b=Object(g.a)(v,2),w=b[0],j=b[1],E=Object(a.useState)(""),y=Object(g.a)(E,2),k=y[0],C=y[1];return r.a.createElement("div",{style:{width:"90%"}},r.a.createElement(x.a,Object.assign({},w,{value:(h=k,void 0!==h&&h.constructor===Object&&0===Object.entries(h).length?"":k),onSelect:function(e){var t=w.options.find((function(t){return t.text===e.target.value}))||{},n=t.center,a=void 0===n?[]:n,r=t.text,o=void 0===r?"":r;C(t),i(a),c(o)},renderInput:function(e){return r.a.createElement(O.a,Object.assign({},e,{label:t,margin:"normal",onChange:function(e){f(e.target.value)}}))}})))}var S=n(73),W=n(75),L=function(e){Object(W.a)(n,e);var t=Object(S.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"_redraw",value:function(e){var t=e.width,n=e.height,a=e.ctx,r=e.isDragging,o=e.project,i=(e.unproject,this.props),c=i.points,l=i.color,u=void 0===l?"red":l,s=i.lineWidth,d=void 0===s?2:s,f=i.renderWhileDragging,m=void 0===f||f;a.clearRect(0,0,t,n),a.globalCompositeOperation="lighter",!m&&r||!c||(a.lineWidth=d,a.strokeStyle=u,a.beginPath(),c.forEach((function(e){var t=o([Number(e[1]),Number(e[0])]);a.lineTo(t[0],t[1])})),a.stroke())}},{key:"render",value:function(){return r.a.createElement(j.a,{redraw:this._redraw.bind(this)})}}]),n}(a.PureComponent),B=n(158),J=n(151),P=Object(p.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}));function D(){i.a.render(r.a.createElement(r.a.Fragment,null),document.getElementById("loading"))}function R(e){i.a.render(r.a.createElement(B.a,{className:e.backdrop,open:!0},r.a.createElement(J.a,{color:"inherit"})),document.getElementById("loading"))}var T=n(156),_=n(154);function z(e){return r.a.createElement(_.a,Object.assign({elevation:6,variant:"filled"},e))}function A(){i.a.render(r.a.createElement(r.a.Fragment,null),document.getElementById("loading"))}function G(e){i.a.render(r.a.createElement(T.a,{open:!0},r.a.createElement(z,{severity:"error"},(null===e||void 0===e?void 0:e.message)||e)),document.getElementById("alert"))}function V(){i.a.render(r.a.createElement(r.a.Fragment,null),document.getElementById("alert"))}n(96),n(97);var Q=Object(p.a)((function(e){return{root:{display:"flex"},appBar:{width:"calc(100% - ".concat(360,"px)"),marginLeft:360},drawer:{width:360,flexShrink:0},drawerPaper:{width:360},drawerContainer:{display:"flex",flexDirection:"row"},geolocateControl:{display:"flex",justifyContent:"flex-end",margin:"20px"},inputContainer:{display:"flex",alignItems:"center",flexDirection:"column",flexGrow:1},searchBtnContainer:{padding:"60px 0"},resultContainer:{display:"flex",alignItems:"left",margin:"-8px 5% 15px 5%",flexDirection:"column"},toolbar:e.mixins.toolbar,content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:e.spacing(3)}}}));var Y=function(e){var t,n,o,i={width:"100%",height:"100%",latitude:37.7577,longitude:122.4376,zoom:13},c=Q(),p=Object(a.useState)(Object(m.a)({},i)),b=Object(g.a)(p,2),O=b[0],x=b[1],y=Object(a.useState)([]),k=Object(g.a)(y,2),C=k[0],S=k[1],W=Object(a.useState)([]),B=Object(g.a)(W,2),J=B[0],T=B[1],_=Object(a.useState)([]),z=Object(g.a)(_,2),Y=z[0],Z=z[1],F=Object(a.useState)(""),q=Object(g.a)(F,2),M=q[0],U=q[1],H=Object(a.useState)(""),$=Object(g.a)(H,2),K=$[0],X=$[1],ee=Object(a.useState)({}),te=Object(g.a)(ee,2),ne=te[0],ae=te[1];"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(e){var t=O.latitude,n=O.longitude;t===i.latitude&&n===i.longitude&&x(Object(m.a)({},i,{latitude:e.coords.latitude,longitude:e.coords.longitude}))}));var re=(t=function(e,t,n){var a=n.value;return n.value=Object(u.a)(l.a.mark((function e(){var t=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.apply(void 0,t);case 3:e.next=10;break;case 5:e.prev=5,e.t0=e.catch(0),A(),G(e.t0),setTimeout((function(){V()}),6e3);case 10:case"end":return e.stop()}}),e,null,[[0,5]])}))),n},n=function(e,t,n){var a=n.value,r=P();return n.value=Object(u.a)(l.a.mark((function e(){var t=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(r),e.next=3,a.apply(void 0,t);case 3:D();case 4:case"end":return e.stop()}}),e)}))),n},o=function(){function e(){Object(s.a)(this,e)}return Object(d.a)(e,null,[{key:"fetchRoute",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,a,r,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I("//mock-api.dev.lalamove.com/route",{method:"POST",body:JSON.stringify({origin:M,destination:K})});case 2:return t=e.sent,n=t.token,e.next=6,I("//mock-api.dev.lalamove.com/route/".concat(n));case 6:a=e.sent,r=a.path,o=a.total_distance,i=a.total_time,S(r),ae({total_distance:o,total_time:i});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Object(f.a)(o,"fetchRoute",[t,n],Object.getOwnPropertyDescriptor(o,"fetchRoute"),o),o);Object(a.useEffect)((function(){M&&K&&re.fetchRoute(),M&&K||(S([]),ae({}))}),[M,K]);var oe=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:c.drawerContainer},r.a.createElement("div",{className:c.inputContainer},r.a.createElement(N,{label:"Starting location",latitude:O.latitude,longitude:O.longitude,value:J.join(","),onChange:function(e){return T(e)},onLocationChange:function(e){return U(e)}}),r.a.createElement(N,{label:"Drop-off point",latitude:O.latitude,longitude:O.longitude,value:Y.join(","),onChange:function(e){return Z(e)},onLocationChange:function(e){return X(e)}})),M&&K&&r.a.createElement("span",{className:c.searchBtnContainer},r.a.createElement(v.a,{"aria-label":"search",className:c.margin,onClick:function(){return re.fetchRoute()}},r.a.createElement(w.a,{fontSize:"inherit"})))),r.a.createElement("div",{className:c.resultContainer},ne.total_distance&&r.a.createElement("span",null,"Total Distance: ",ne.total_distance),ne.total_time&&r.a.createElement("span",null,"Total Time: ",ne.total_time)))};return r.a.createElement("div",{style:{height:"100vh",width:"100%"}},E.isMobile?oe():r.a.createElement(h.a,{className:c.drawer,variant:"permanent",classes:{paper:c.drawerPaper},anchor:"left"},oe()),r.a.createElement(j.d,Object.assign({},O,{mapboxApiAccessToken:"pk.eyJ1IjoibGljYW9tZW5nIiwiYSI6ImNrZ2NnbmRxNzA0anAydWw4cDhkeW15OGEifQ.fy4izQyEJV3Ld-J0piVWBg",onViewportChange:function(e){return x(e)},onClick:function(e){var t=Object(g.a)(e.lngLat,2),n=t[0],a=t[1];J.length?Y.length||Z([n,a]):T([n,a])}}),r.a.createElement("div",{className:c.geolocateControl},(!M||!K)&&r.a.createElement(j.b,{positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})),C.map((function(e,t){return r.a.createElement(j.c,{key:t,offsetTop:-10,offsetLeft:-15,longitude:Number(e[1]),latitude:Number(e[0])},r.a.createElement("b",null,++t))})),J.length?r.a.createElement(j.c,{offsetTop:-10,offsetLeft:-5,longitude:J[0],latitude:J[1]},r.a.createElement("svg",{width:"10",height:"10",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("image",{href:"https://www.flaticon.com/svg/static/icons/svg/33/33759.svg",height:"10",width:"10"}))):null,Y.length?E.isSafari?r.a.createElement(j.c,{offsetTop:-16,offsetLeft:-32,longitude:Y[0],latitude:Y[1]},r.a.createElement("svg",{width:"32",height:"32",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("image",{href:"https://www.flaticon.com/svg/static/icons/svg/252/252025.svg",height:"32",width:"32"}))):r.a.createElement(j.c,{offsetTop:-27,offsetLeft:-11,longitude:Y[0],latitude:Y[1]},r.a.createElement("svg",{width:"12",height:"12",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("image",{href:"https://www.flaticon.com/svg/static/icons/svg/565/565949.svg",height:"12",width:"12"})),r.a.createElement("svg",{transform:"translate(-22,-8)",width:"32",height:"32",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("image",{href:"https://www.flaticon.com/svg/static/icons/svg/252/252025.svg",height:"32",width:"32"}))):null,M&&K&&r.a.createElement(L,{points:C})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(100).config(),i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},85:function(e,t,n){e.exports=n(103)},90:function(e,t,n){},97:function(e,t,n){}},[[85,1,2]]]);
//# sourceMappingURL=main.317c217f.chunk.js.map